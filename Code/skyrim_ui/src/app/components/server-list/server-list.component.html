<!-- Please do further testing with a ton of servers in the list and names that are too long/contain symbols -->

<input
  class="search-list-server"
  [formControl]="formSearch"
  type="text"
  [placeholder]="'COMPONENT.SERVER_LIST.SEARCH' | transloco"
  autocomplete="off"
  autocorrect="off"
  autocapitalize="off"
  spellcheck="false"
/>

<button class="buttons-server-list" [disabled]="loader.serverlist.inProgress$ | async" (click)="updateServerList()">
  {{ 'COMPONENT.SERVER_LIST.REFRESH' | transloco }}
</button>
<button class="buttons-server-list" (click)="cancel()">
  {{ 'COMPONENT.SERVER_LIST.BACK' | transloco }}
</button>


<ng-container *ngIf="filteredServerlist$ | async as serverlist">
  <div *ngIf="loader.serverlist.inProgress$ | async; else notLoading" class="serverlist-alternative">
    {{ 'COMPONENT.SERVER_LIST.LOADING' | transloco }}
  </div>

  <ng-template #notLoading>
    <div class="serverlist-alternative" *ngIf="serverlist.length === 0; else notEmpty">
      {{ 'COMPONENT.SERVER_LIST.NO_SERVERS' | transloco }}
    </div>

    <ng-template #notEmpty>
      <div class="container-list">
        <div class="scrollbar-offset">
          <div class="servers-list-table">
            <div class="row header">
              <div>
                {{ 'COMPONENT.SERVER_LIST.TABLE_HEADERS.NAME' | transloco }}
                <app-order [isIncreasingOrder]="isIncreasingNameOrder | async" (sorted)="sortName($event)"></app-order>
              </div>
              <div style="width: 6em">
                {{ 'COMPONENT.SERVER_LIST.TABLE_HEADERS.PLAYERS' | transloco }}
                <app-order [isIncreasingOrder]="isIncreasingPlayerOrder | async" (sorted)="sortPlayerCount($event)"></app-order>
              </div>
              <!-- <div style="width: 6em">-->
              <!--   {{ 'COMPONENT.SERVER_LIST.TABLE_HEADERS.COUNTRY' | transloco }}-->
              <!--   <app-order [isIncreasingOrder]="isIncreasingCountryOrder | async" (sorted)="sortCountry($event)"></app-order>-->
              <!-- </div>-->
              <div style="width: 5em">{{ clientVersion$ | async }}</div>
              <div style="width: 6em;">
                <!-- Pls not automatic fav on top, make it sortable like other titles, thanks! -->
                {{ 'COMPONENT.SERVER_LIST.TABLE_HEADERS.FAVORITE' | transloco }}
                <app-order [isIncreasingOrder]="isIncreasingFavoriteOrder | async" (sorted)="sortFavorite($event)"></app-order>
              </div>
              <div style="width: 4em;"></div>
            </div>
          </div>
        </div>

        <cdk-virtual-scroll-viewport itemSize="38" class="virtual-viewport">
          <div class="servers-list-table">
            <div *cdkVirtualFor="let server of serverlist" class="row">
              <div>{{ server.name }}</div>
              <div style="width: 6em">{{ server.player_count }}</div>
              <!-- <div style="width: 6em">{{ server.country }}</div>-->
              <div style="width: 5em" [ngClass]="server.isCompatible ? 'server-compatible' : 'server-incompatible'">{{ server.shortVersion }}</div>
              <div style="width: 6em;" (click)="toggleServerFavorite(server)" class="app-server-list-not-favorite">
                <fa-icon [icon]="server.isFavorite ? fasStar : farStar"></fa-icon>
              </div>
              <div style="width: 4em;">
                <button (click)="connect(server)" class="join-button" [disabled]="!server.isCompatible">
                  {{ 'COMPONENT.SERVER_LIST.JOIN' | transloco }}
                </button>
              </div>
            </div>
          </div>
        </cdk-virtual-scroll-viewport>
      </div>
    </ng-template>
  </ng-template>
</ng-container>
